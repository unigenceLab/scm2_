<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>세한텍스타일</title>
  <style>
    :root{
      --header-h: 20px;
      --overlay-left: 168px; /* SCM 오버레이: 왼쪽에서 168px 띄움 */
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    /* 전체 레이아웃: 위 20px, 아래 나머지 */
    .app {
      height: 100%;
      display: grid;
      grid-template-rows: var(--header-h) 1fr;
    }

    /* 상단바 */
    .topbar {
      height: var(--header-h);
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 6px;
      padding: 0 6px;
      box-sizing: border-box;
      background: #f5f5f5;
      border-bottom: 1px solid #ddd;
      overflow: hidden;
    }

    .topbar button {
      height: 16px;
      line-height: 16px;
      font-size: 11px;
      padding: 0 8px;
      border: 1px solid #bbb;
      background: #fff;
      border-radius: 4px;
      cursor: pointer;
    }

    /* 아래 영역 */
    .content {
      position: relative;
      height: 100%;
      overflow: hidden;
    }

    /* 기본 MES iframe */
    #mesFrame {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* SCM 오버레이가 열리면 왼쪽 여백(overlay-left) 영역을 딤 + 클릭 차단 */
    #leftShield{
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      width: var(--overlay-left);
      display: none;                 /* 기본 숨김 */
      background: rgba(0,0,0,0.30);  /* 투명도 30% */
      z-index: 9;                    /* SCM 오버레이(10) 아래, MES(기본) 위 */
      pointer-events: auto;          /* 클릭/스크롤 가로채기 */
    }

/* SCM 오버레이 */
    #scmOverlay {
      position: absolute;
      top: 0;
      left: var(--overlay-left);
      right: 0;
      bottom: 0;
      width: calc(100% - var(--overlay-left)); /* 왼쪽 띄운 뒤 나머지 꽉 채움 */
      height: 100%;
      display: none; /* 기본 숨김 */
      background: #fff;
      box-sizing: border-box;
      z-index: 10;
      border-left: 1px solid #ddd;
    }

    #scmFrame {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* 닫기 버튼 */
    #closeScm {
      position: absolute;
      top: 6px;
      right: 6px;
      z-index: 11;
      height: 18px;
      line-height: 18px;
      font-size: 11px;
      padding: 0 8px;
      border: 1px solid #bbb;
      background: rgba(255,255,255,0.9);
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div class="app">
    <div class="topbar">
      <button id="btnMes" type="button">메인</button>
      <button id="btnScm" type="button">외주공정발주</button>
    </div>

    <div class="content">
      <!-- SCM 오버레이가 열리면 왼쪽 여백(168px)을 클릭 불가 + 30% 딤 처리 -->
      <div id="leftShield" aria-hidden="true"></div>

      <!-- 아래 기본 iframe (MES) -->
      <iframe id="mesFrame" src="https://sehan.polarvo.com/20251021_gfuf"></iframe>

      <!-- SCM 오버레이: MES 위를 덮음 -->
      <div id="scmOverlay" aria-hidden="true">
        <button id="closeScm" type="button">닫기</button>
        <iframe id="scmFrame" src="https://scmorder.polarvo.com/20260130_seha"></iframe>
      </div>
    </div>
  </div>

  <script>
    const MES_URL = "https://sehan.polarvo.com/20251021_gfuf";
    const SCM_URL = "https://scmorder.polarvo.com/20260130_seha";

    const mesFrame = document.getElementById("mesFrame");
    const scmOverlay = document.getElementById("scmOverlay");
    const scmFrame = document.getElementById("scmFrame");

    const leftShield = document.getElementById("leftShield");

    const btnMes = document.getElementById("btnMes");
    const btnScm = document.getElementById("btnScm");
    const closeScm = document.getElementById("closeScm");

    mesFrame.src = MES_URL;
    scmFrame.src = SCM_URL;

    function openScm(){
      leftShield.style.display = "block";
      leftShield.setAttribute("aria-hidden", "false");
      scmOverlay.style.display = "block";
      scmOverlay.setAttribute("aria-hidden", "false");
    }
    function closeScmOverlay(){
      scmOverlay.style.display = "none";
      scmOverlay.setAttribute("aria-hidden", "true");
      leftShield.style.display = "none";
      leftShield.setAttribute("aria-hidden", "true");
    }

    btnScm.addEventListener("click", openScm);
    closeScm.addEventListener("click", closeScmOverlay);

    // MES 버튼 누르면 SCM 닫고(덮개 제거) MES가 보이게
    btnMes.addEventListener("click", closeScmOverlay);

    // ESC로 닫기
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeScmOverlay();
    });
  </script>
</body>
</html>
